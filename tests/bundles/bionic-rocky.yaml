local_overlay_enabled: False

variables:
  openstack-origin: &openstack-origin cloud:bionic-rocky

series: &series bionic

applications:
  percona-cluster:
    constraints: mem=3072M
    charm: ch:percona-cluster
    num_units: 1
    options:
      source: *openstack-origin
    channel: 5.7/edge
  rabbitmq-server:
    charm: ch:rabbitmq-server
    num_units: 1
    options:
      source: *openstack-origin
    channel: 3.6/edge
  neutron-api:
    charm: ../../neutron-api.charm
    series: *series
    num_units: 1
    options:
      flat-network-providers: physnet1
      neutron-security-groups: true
      openstack-origin: *openstack-origin
  keystone:
    charm: ch:keystone
    num_units: 1
    options:
      openstack-origin: *openstack-origin
    channel: train/edge
relations:
  - - 'neutron-api:shared-db'
    - 'percona-cluster:shared-db'
  - - 'neutron-api:amqp'
    - 'rabbitmq-server:amqp'
  - - 'neutron-api:identity-service'
    - 'keystone:identity-service'
  - - 'keystone:shared-db'
    - 'percona-cluster:shared-db'
